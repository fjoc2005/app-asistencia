<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador - APP Asistencia</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Face API for enrollment -->
    <script src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.min.js"></script>
</head>

<body class="admin-page">
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-icon-small">
                    <i data-lucide="clipboard-check"></i>
                </div>
                <h3>APP Asistencia</h3>
            </div>

            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" onclick="showView('dashboard')">
                    <i data-lucide="layout-dashboard"></i>
                    Dashboard
                </a>
                <a href="#control-asistencia" class="nav-item" onclick="showView('controlAsistencia')">
                    <i data-lucide="clipboard-check"></i>
                    Control de Asistencia
                </a>
                <a href="#nomina-socias" class="nav-item" onclick="showView('nominaSocias')">
                    <i data-lucide="users"></i>
                    Nómina de Socias
                </a>
            </nav>

            <div class="sidebar-footer">
                <button class="btn-logout" onclick="logout()">
                    <i data-lucide="log-out"></i>
                    Cerrar Sesión
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <h1 id="viewTitle">Dashboard</h1>
                <div class="admin-user">
                    <i data-lucide="user-circle"></i>
                    <span id="adminEmail">administracion@gmail.com</span>
                </div>
            </header>

            <!-- Dashboard View -->
            <div id="dashboardView" class="view-content active">
                <div class="stats-grid">
                    <div class="stat-card animate-scale-in" style="animation-delay: 0.1s">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i data-lucide="users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalUsuarios">0</h3>
                            <p>Total Usuarios</p>
                        </div>
                    </div>

                    <div class="stat-card animate-scale-in" style="animation-delay: 0.2s">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i data-lucide="calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="asistenciasHoy">0</h3>
                            <p>Asistencias Hoy</p>
                        </div>
                    </div>

                    <div class="stat-card animate-scale-in" style="animation-delay: 0.3s">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i data-lucide="calendar"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalReuniones">0</h3>
                            <p>Reuniones Activas</p>
                        </div>
                    </div>

                    <div class="stat-card animate-scale-in" style="animation-delay: 0.4s">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                            <i data-lucide="image"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="fotosRegistradas">0</h3>
                            <p>Fotos Registradas</p>
                        </div>
                    </div>
                </div>

                <div class="recent-activity">
                    <h2>Actividad Reciente</h2>
                    <div id="recentActivityList" class="activity-list">
                        <p class="empty-state">No hay actividad reciente</p>
                    </div>
                </div>
            </div>

            <!-- Reuniones View -->
            <div id="reunionesView" class="view-content">
                <div class="view-header">
                    <div class="search-bar">
                        <i data-lucide="search"></i>
                        <input type="text" id="searchReuniones" placeholder="Buscar reuniones...">
                    </div>
                    <button class="btn-primary" onclick="showNuevaReunionModal()">
                        <i data-lucide="plus"></i>
                        Nueva Reunión
                    </button>
                </div>

                <div class="meetings-grid" id="meetingsGrid">
                    <p class="empty-state">No hay reuniones registradas</p>
                </div>
            </div>

            <!-- Usuarios View -->
            <div id="usuariosView" class="view-content">
                <div class="view-header">
                    <div class="search-bar">
                        <i data-lucide="search"></i>
                        <input type="text" id="searchUsuarios" placeholder="Buscar por RUT o nombre...">
                    </div>
                    <button class="btn-primary" onclick="showNuevoUsuarioModal()">
                        <i data-lucide="user-plus"></i>
                        Nuevo Usuario
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>RUT</th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usuariosTableBody">
                            <tr>
                                <td colspan="5" class="empty-state">No hay usuarios registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Asistencias View -->
            <div id="asistenciasView" class="view-content">
                <div class="view-header">
                    <div class="search-bar">
                        <i data-lucide="search"></i>
                        <input type="text" id="searchAsistencias" placeholder="Buscar asistencias...">
                    </div>
                    <div class="filter-group">
                        <select id="filterReunion" class="filter-select">
                            <option value="">Todas las reuniones</option>
                        </select>
                        <input type="date" id="filterFecha" class="date-input">
                        <button class="btn-secondary" onclick="filtrarAsistencias()">
                            <i data-lucide="filter"></i>
                            Filtrar
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>RUT</th>
                                <th>Nombre</th>
                                <th>Reunión</th>
                                <th>Método</th>
                            </tr>
                        </thead>
                        <tbody id="asistenciasTableBody">
                            <tr>
                                <td colspan="6" class="empty-state">No hay asistencias registradas</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Inasistentes View -->
            <div id="inasistentesView" class="view-content">
                <div class="view-header">
                    <h2>Gestión de Inasistencias</h2>
                    <button class="btn-primary" onclick="showRegistrarInasistenciaModal()">
                        <i data-lucide="user-x"></i>
                        Registrar Inasistencia
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Reunión</th>
                                <th>RUT</th>
                                <th>Nombre</th>
                                <th>Justificación</th>
                                <th>Fecha Registro</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="inasistentesTableBody">
                            <tr>
                                <td colspan="6" class="empty-state">No hay inasistencias registradas</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Enrolamiento Facial View -->


            <!-- Importar View -->
            <div id="importarView" class="view-content">
                <div class="import-section">
                    <h2>Importar Usuarios Masivamente</h2>
                    <p>Sube un archivo CSV con los datos de los usuarios</p>

                    <div class="upload-area" id="uploadArea">
                        <i data-lucide="upload-cloud"></i>
                        <h3>Arrastra tu archivo CSV aquí</h3>
                        <p>o haz clic para seleccionar</p>
                        <input type="file" id="csvFile" accept=".csv" style="display: none;">
                        <button class="btn-secondary" onclick="document.getElementById('csvFile').click()">
                            Seleccionar Archivo
                        </button>
                    </div>

                    <div class="csv-format-info">
                        <h3>Formato del CSV</h3>
                        <p>El archivo debe contener las siguientes columnas:</p>
                        <code>RUT,Nombre,Email,Estado</code>
                        <p class="example">Ejemplo: 12345678-9,Juan Pérez,juan@email.com,Activo</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Nueva Reunión -->
    <div id="nuevaReunionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Reunión</h3>
                <button class="btn-close" onclick="closeModal('nuevaReunionModal')">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <form id="nuevaReunionForm">
                <div class="form-group">
                    <label for="reunionNombre">Nombre de la Reunión</label>
                    <input type="text" id="reunionNombre" placeholder="Reunión Mensual Enero" required>
                </div>
                <div class="form-group">
                    <label for="reunionFecha">Fecha</label>
                    <input type="date" id="reunionFecha" required>
                </div>
                <div class="form-group">
                    <label for="reunionHora">Hora</label>
                    <input type="time" id="reunionHora" required>
                </div>
                <div class="form-group">
                    <label for="reunionDescripcion">Descripción</label>
                    <textarea id="reunionDescripcion" rows="3" placeholder="Descripción de la reunión"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary"
                        onclick="closeModal('nuevaReunionModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Crear Reunión</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Nuevo Usuario -->
    <div id="nuevoUsuarioModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Usuario</h3>
                <button class="btn-close" onclick="closeModal('nuevoUsuarioModal')">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <form id="nuevoUsuarioForm">
                <div class="form-group">
                    <label for="nuevoRut">RUT</label>
                    <input type="text" id="nuevoRut" placeholder="12.345.678-9" required>
                </div>
                <div class="form-group">
                    <label for="nuevoNombre">Nombre Completo</label>
                    <input type="text" id="nuevoNombre" placeholder="Juan Pérez" required>
                </div>
                <div class="form-group">
                    <label for="nuevoEmail">Email</label>
                    <input type="email" id="nuevoEmail" placeholder="juan@email.com" required>
                </div>
                <div class="form-group">
                    <label for="nuevoEstado">Estado</label>
                    <select id="nuevoEstado">
                        <option value="Activo">Activo</option>
                        <option value="Inactivo">Inactivo</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary"
                        onclick="closeModal('nuevoUsuarioModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar Usuario</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Registrar Inasistencia -->
    <div id="registrarInasistenciaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Inasistencia</h3>
                <button class="btn-close" onclick="closeModal('registrarInasistenciaModal')">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <form id="registrarInasistenciaForm">
                <div class="form-group">
                    <label for="inasistenciaReunion">Reunión</label>
                    <select id="inasistenciaReunion" required>
                        <option value="">-- Selecciona una reunión --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="inasistenciaUsuario">Usuario</label>
                    <select id="inasistenciaUsuario" required>
                        <option value="">-- Selecciona un usuario --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="inasistenciaJustificacion">Justificación</label>
                    <textarea id="inasistenciaJustificacion" rows="4"
                        placeholder="Ingresa la justificación de la inasistencia..." required></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary"
                        onclick="closeModal('registrarInasistenciaModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Registrar Inasistencia</button>
                </div>
            </form>
        </div>
    </div>

    <script src="admin.js"></script>
    <script>
        lucide.createIcons();
    </script>
</body>

</html>